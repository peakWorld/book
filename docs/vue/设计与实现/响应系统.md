# 响应系统的作用与实现

## 响应式数据和副作用函数
* 副作用函数: 会产生副作用的函数, 函数的执行会直接或间接影响其他函数的执行。
* 响应式数据: 值变化后, 副作用函数自动重新执行。

## 响应式数据的实现
* 拦截对象的读取和设置操作
  * 读取操作时将副作用函数存在一个‘桶’中
  * 设置操作时将副作用函数从‘桶’中取出并执行
* 数据结构
  * WeakMap 由 target(对象) --> Map构成
  * Map     由 key(属性) --> Set构成, 其内为副作用函数
* 分支切换
```js
  effect(() => {
    document.body.innerText = obj.ok ? obj.text : 'not'
  })

  // obj.ok 为 true
  // ‘桶’ 中添加 ‘ok’、‘text’ 副作用函数

  // obj.ok = false
  // 只执行 ‘ok’ 副作用函数

  // obj.text = ‘abc’
  // 执行 ‘text’ 副作用函数, 但是 body 的文本不会变
```